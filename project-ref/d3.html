<!DOCTYPE html>
<html>
<head>
	<title>Project 1 - sample code 2</title>
	<script type="text/javascript" src="https://d3js.org//d3.v3.min.js"></script>
	<script src="//d3js.org/d3.v4.js"></script>
	<style>
    	text { 
			font-family: Arial; 
			font-size: 15px;
		}
		.axis path, .axis line {
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.tick text {
			fill: black;
			font-size: 11px;
		}

		rect {
			stroke: white;
		}
	</style>
</head>
<body>

  

  <div class="row">
	<div class="col-lg-8" id="main_panel">
	</div>
  </div>
</div>
	

	
	<script>
	var width = 600
	var height = 600
	var streets=[];
	var zoom = d3.behavior.zoom().scaleExtent([1, 10]).on("zoom", zoomed);
      var svgContainer = d3.select("#main_panel")
      .append("svg")
      .attr("width", width)
      .attr("height", height)//.style("border", "0.5px solid #C0C0C0")
      .attr("x", "20px")
      .attr("y", "20px")
	  .call(zoom)
      //.call(d3.zoom().on("zoom", function() {svgContainer.attr("transform", d3.event.transform)}))
      .append("g");
	
	
	
	
	function zoomed() {
    svgContainer.attr("transform",
        "translate(" + zoom.translate() + ")" +
        "scale(" + zoom.scale() + ")"
    );
}
	
	
	
	
	//To draw street map  
	
	d3.json('data/streets.json',function(error, streets) {
				streets.forEach(function(data){
					
					var lineCoords=d3.svg.line()
					.x(function(d) {return d.x*30;})
					.y(function(d) {return height-d.y*30;})
					.interpolate("linear"); 
					
			lineCoords(data);
			
			var svgPath = svgContainer
				//.attr("d", geoPath(lineCoords)).style("stroke", "#1c9099").attr("vector-effect", "non-scaling-stroke")
				//.attr("x", "-20px")
				//.attr("y", "20px")
				.append("path")
				.attr('stroke', 'steelblue')
    			.attr('stroke-width', '3px')
				.attr("fill", "none");
			svgPath.attr("d", lineCoords(data));
			
			});
		});
		
	//To insert pumps
	var g = d3.select('svgContainer').select('g');
	
	d3.csv('data/pumps.csv',function(error, pumps) {
	
					
				   svgContainer.selectAll("circle")
					.data(pumps)
					.enter().append("circle")
					.attr("cx", function(d) { return d.x*30; })
					.attr("cy", function(d) { return height-d.y*30; })
					//var svgpump = svgContainer
					//.append('circle')
					.style('fill', 'red')
					.attr('r', 10)
					.attr("stroke", 'grey')
					.attr("stroke-opacity",0.8);
				//svgpump.attr("d", pumpcoords(data))
					//.attr('cx', function(d) {return d.x*30; })
					//.attr('cx', function(d) {return height-d.y*30; });
					});		

 function markStreetNames() {

    //Street data
    // GeoJSON MultiFeatureCollection Object
var streetNames = {
  "type": "FeatureCollection",
  "features": [
      {
          "type": "Feature",
          "geometry": {
              "type": "Point",
              "coordinates": [
                  -40,
                  12
              ]
          },
          "properties": {
              "name": "Brewer Street"
          }
      },
      {
          "type": "Feature",
          "geometry": {
              "type": "Point",
              "coordinates": [
                13.15651,
                11.15159
              ]
          },
          "properties": {
              "name": "Broad Street"
          }
      },
      {
          "type": "Feature",
          "geometry": {
              "type": "Point",
              "coordinates": [
                  -10,
                  12
              ]
          },
          "properties": {
              "name": "Oxford Street"
          }
      },
      {
          "type": "Feature",
          "geometry": {
              "type": "Point",
              "coordinates": [
                4.15651,
                8.15159
              ]
          },
          "properties": {
              "name": "Regent Street"
          }
      },
      {
        "type": "Feature",
        "geometry": {
            "type": "Point",
            "coordinates": [
                65,
                12
            ]
        },
        "properties": {
            "name": "Dean Street"
        }
      },
      {
        "type": "Feature",
        "geometry": {
            "type": "Point",
            "coordinates": [
              10.15651,
              11.15159
            ]
        },
        "properties": {
            "name": "Carnaby Street"
        }
      },
      {
        "type": "Feature",
        "geometry": {
            "type": "Point",
            "coordinates": [
                -80.83556459443902,
                35.39917224760999
            ]
        },
        "properties": {
            "name": "Warwick Street"
        }
      }
  ]
};

console.log("Streets:" + streetNames);

// set projection
var projection = d3.geoMercator();

	// set projection parameters
	projection.scale(1200).center([ 20,8.5])
  
svgContainer.selectAll(".place-label")
.data(streetNames.features)
.enter().append("text")
.attr("class", "place-label")
.attr("transform", function(d) { return "translate(" + projection(d.geometry.coordinates) + ") rotate(60)"; })
.attr("x", function(d) { return d.geometry.coordinates[0] > -1 ? 6 : -6; })
.attr("dy", ".10em")
.style("text-anchor", function(d) { return d.geometry.coordinates[0] > -1 ? "start" : "end"; })
.text(function(d) { return d.properties.name; });
}	

markStreetNames();	
</script>
				
</body>
</html>