<!DOCTYPE html>
<html>
<head>
	<title>Project 1 - sample code 2</title>
	<script type="text/javascript" src="./d3/d3.js"></script>
<!--<script type="text/javascript" src="https://d3js.org//d3.v3.min.js"></script> -->
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
	
	<style>
    	text { 
			font-family: Arial; 
			font-size: 15px;
		}
		.axis path, .axis line {
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.tick text {
			fill: black;
			font-size: 11px;
		}

		rect {
			stroke: white;
		}
		
	div.tooltip { 
    position: absolute;     
    text-align: center;     
    width: 80px;          
    height: 28px;         
    padding: 2px;       
    font: 12px sans-serif;    
    background: lightsteelblue; 
    border: 0px;    
    border-radius: 8px;     
    pointer-events: none;     
}

.bar1 {
  fill: steelblue;
}
.bar2 {
  fill: orange;
}

.bar1:hover {
  fill: brown;
}

.bar2:hover {
  fill: brown;
}


.axis--x path {
  display: none;
}


	</style>
</head>
<body>
<div class="row">
	  
	 <h3>&nbsp Dr. John Snow's Map of London's 1854 cholera epidemic &nbsp&nbsp&nbsp&nbsp&nbsp <a href="documentation.html">Documentation</a></h3>
        <div id="zoom">
			<button id="zoom_in">+</button>
			<button id="zoom_out">-</button>
		</div>
 </div>
	
<svg id="main" width="1600" height="1500">
		<g id='street' transform="translate(-50,-20)"></g>
		<g id='victim' transform="translate(-50,-20)"></g>
		<g id='pump' transform="translate(-50,-20)"></g>                   // changed this and move this down
		<g id='victimonclick' transform="translate(-50,-20)"></g>    <!--Changed here-->
		
		<g id='deathdays' transform="translate(30,40)"></g>
</svg>
	
	<script>
	
	var width = 600         // changed this
	var height = 600        // changed this , <> updated to 600 from 800
	var streets=[];
	
    var zoom = d3.behavior.zoom().scaleExtent([1, 10]).on("zoom", zoomed);
	 
	 //d3.select("button").on('click', zoomed);
	 //d3.selectAll('button').select("#zoom_in").on('click', zoomed);
	 
	 var gstreet= d3.select('svg').select("#street");         //  added select('svg') here
	 var gpump= d3.select('svg').select("#pump");				//  added select('svg') here
	 var gvictim= d3.select('svg').select("#victim");			//  added select('svg') here
	 var gdeathdays= d3.select('svg').select("#deathdays");		//  added select('svg') here
	 var gvictimonclick = d3.select('svg').select("#victimonclick");  // added new group here
	 
	 
	 var div = d3.select("body").append("div") 
    .attr("class", "tooltip")       
    .style("opacity", 0);
	
	//var svg=
      var svgContainer = d3.select("body").select("#main")
      .append("svg")
      .attr("width", width)
      .attr("height", height)//.style("border", "0.5px solid #C0C0C0")
      .attr("x", "20px")
      .attr("y", "20px")
	  .call(zoom);
	  
      //.append("g");/.call(d3.zoom().on("zoom", function() {svgContainer.attr("transform", d3.event.transform)}))
	   //.attr("transform", "translate(-80,0)")
	//.append("g");
	
	
	
	
	function zoomed() {
    svgContainer.attr("transform",
        "translate(" + zoom.translate() + ")" +
        "scale(" + zoom.scale() + ")"
    );
}
	
	//To draw street map  
	
	d3.json('data/streets.json',function(error, streets) {
				streets.forEach(function(data){
					
					var lineCoords=d3.svg.line()
					.x(function(d) {return d.x*30;})
					.y(function(d) {return height-d.y*30;})
					.interpolate("linear"); 
					
			lineCoords(data);
	 // set projection
	
    //var projection = d3.geoMercator().scale(1200).center([ 20, 8.5 ])

    // set projection parameters
    //projection.scale(1200).center([ 20, 8.5 ])
	// create path variable
    //var geoPath = d3.geoPath().projection(projection);
			
	var svgPath = gstreet
			//var svgPath = svgContainer
				//.attr("d", geoPath(lineCoords)).style("stroke", "#1c9099").attr("vector-effect", "non-scaling-stroke")
				//.attr("x", "-20px")
				//.attr("y", "20px")
				//g.selectAll("path")
				.append("path")
				.attr('stroke', 'grey')
    			.attr('stroke-width', '3px')
				.attr("stroke-opacity",0.8)
				.attr("fill", "none")
			    .attr("d", lineCoords(data));// modified here    
			
			});
		});
		
	//To insert pumps
	//var g = d3.select('svgContainer').select('gpump');
	
	d3.csv('data/pumps.csv',function(error, pumps) {
	
					
				  // svgContainer.selectAll("circle")
				    gpump.selectAll("circle")
					.data(pumps)
					.enter().append("circle")
					.attr("cx", function(d) { return d.x*30; })
					.attr("cy", function(d) { return height-d.y*30; })
					//var svgpump = svgContainer
					//.append('circle')
					.style('fill', 'red')
					.attr('r', 7)
					.attr("stroke", 'grey')
					.attr("stroke-opacity",0.8);
				    //svgpump.attr("d", pumpcoords(data))
					//.attr('cx', function(d) {return d.x*30; })
					//.attr('cx', function(d) {return height-d.y*30; });
					});
					

	//var g = d3.select('svgContainer').select('gvictim');
	
	d3.csv('data/deaths_age_sex.csv',function(error, victims) {
	
					
				   gvictim.selectAll("rect")
					.data(victims)
					.enter()
					.append("rect")
					.attr("x", function(d) { return d.x*30; })
					.attr("y", function(d) { return height-d.y*30; })
					//var svgpump = svgContainer
					//.append('circle')
					.attr('width', 5)
					.attr('height',7)
					.style('fill', function(d)
					  {
						if(d.gender == "0")
						{return "blue";}
						else
						{return "lime";}
					  }
					)
					//.style('fill', 'green')
					//.attr('r', 10)
					.attr("stroke", 'steelblue')
					.attr("stroke-opacity",0.8);
				//svgpump.attr("d", pumpcoords(data))
					//.attr('cx', function(d) {return d.x*30; })
					//.attr('cx', function(d) {return height-d.y*30; });
					});  
					
					
function deathagesex_total()
{
			var age0m=0; var age0f=0; var age11f=0; var age11m=0; 
   			var age21f=0; var age21m=0; var age41f=0; var age41m=0; 
   			var age61f=0; var age61m=0; var age81f=0; var age81m=0;

		for (b=0;b<sdata.length;b++)
   			{
   				
   				var s=Number(sdata[b].age);
   				switch(s)
   				{

   					case 0:
   				

   						if(sdata[b].gender==0)
   						{
   							age0m+=1;
   						}else{
   							age0f+=1;
   						}

   						break;

   					case 1:

   						if(sdata[b].gender==0)
   						{
   							age11m+=1;
   						}else{
   							age11f+=1;
   						}

   						break;

   					case 2:
   						if(sdata[b].gender==0)
   						{
   							age21m+=1;
   						}else{
   							age21f+=1;
   						}

   						break;

   					case 3:
   						if(sdata[b].gender==0)
   						{
   							age41m+=1;
   						}else{
   							age41f+=1;
   						}

   						break;

   					case 4:
   						if(sdata[b].gender==0)
   						{
   							age61m+=1;
   						}else{
   							age61f+=1;
   						}

   						break;

   					case 5:
   						if(sdata[b].gender==0)
   						{
   							age81m+=1;
   						}else{
   							age81f+=1;
   						}

   						break;

   					default:
   					    console.log("errorrrr");
   				}

   			}

var overall = [{age: 5, male: age0m, female: age0f,age1:0,age2:10},
			   {age: 15, male: age11m, female: age11f,age1:11,age2:20},
   			   {age: 30, male: age21m, female: age21f,age1:21,age2:40},
			   {age: 50, male: age41m, female: age41f,age1:41,age2:60},
   			   {age: 70, male: age61m, female: age61f,age1:61,age2:80},
			   {age: 85, male: age81m, female: age81f,age1:80,age2:"higher"}]

console.log(overall);				
}	
			
//Overall Chart
var sdata=[];


d3.csv('data/deaths_age_sex.csv',function(deathagesex) {

		deathagesex.forEach(function(d){
		sdata.push({
			x: d.x*30,
			y: height-d.y*30,
			age: d.age,
			gender: d.gender
		});
		});
		
		console.log(sdata);
		
		var color = d3.scale.category20b();
		
		gvictim.selectAll("rect")
					.data(sdata)
					.attr("id","victims")
					.enter()
					.append("rect")
					.attr("x", function(d) { return d.x*30; })
					.attr("y", function(d) { return height-d.y*30; })
					.attr('width', 5)
					.attr('height',7)
					.style('fill', function(d)
					  {
						if(d.gender == "0")
						{return "blue";}
						else
						{return "lime";}
					  }
					)
	

			var age0m=0; var age0f=0; var age11f=0; var age11m=0; 
   			var age21f=0; var age21m=0; var age41f=0; var age41m=0; 
   			var age61f=0; var age61m=0; var age81f=0; var age81m=0;

		for (b=0;b<sdata.length;b++)
   			{
   				
   				var s=Number(sdata[b].age);
   				switch(s)
   				{

   					case 0:
   				

   						if(sdata[b].gender==0)
   						{
   							age0m+=1;
   						}else{
   							age0f+=1;
   						}

   						break;

   					case 1:

   						if(sdata[b].gender==0)
   						{
   							age11m+=1;
   						}else{
   							age11f+=1;
   						}

   						break;

   					case 2:
   						if(sdata[b].gender==0)
   						{
   							age21m+=1;
   						}else{
   							age21f+=1;
   						}

   						break;

   					case 3:
   						if(sdata[b].gender==0)
   						{
   							age41m+=1;
   						}else{
   							age41f+=1;
   						}

   						break;

   					case 4:
   						if(sdata[b].gender==0)
   						{
   							age61m+=1;
   						}else{
   							age61f+=1;
   						}

   						break;

   					case 5:
   						if(sdata[b].gender==0)
   						{
   							age81m+=1;
   						}else{
   							age81f+=1;
   						}

   						break;

   					default:
   					    console.log("errorrrr");
   				}

   			}

var overall = [{age: 5, male: age0m, female: age0f,age1:0,age2:10},
			   {age: 15, male: age11m, female: age11f,age1:11,age2:20},
   			   {age: 30, male: age21m, female: age21f,age1:21,age2:40},
			   {age: 50, male: age41m, female: age41f,age1:41,age2:60},
   			   {age: 70, male: age61m, female: age61f,age1:61,age2:80},
			   {age: 85, male: age81m, female: age81f,age1:80,age2:"higher"}]

console.log(overall);


//for bar chart

//
var margin2 = {top: 80, right: 80, bottom: 80, left: 80},
    w2 = 600 - margin2.left - margin2.right,        // <> updated from 1380 to 600
    h2 = 400 - margin2.top - margin2.bottom;  
	
var canvas2 =d3.select("#main")
		.append("svg")
		.attr("width", w1 + margin1.left - margin1.right+200)
		.attr("height", 3*h1 + margin1.top + margin1.bottom)
		.append("g")
		.attr("class", "graph")
		.attr("transform", "translate(70,700)")
		//.attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");
		
var x1 = d3.scale.ordinal().rangeRoundBands([0, w2], .1);
var y0 = d3.scale.linear().domain([0, 100]).range([h2, 0]);
var y1 = d3.scale.linear().domain([0, 100]).range([h2, 0]);

var xAxis1 = d3.svg.axis()
    .scale(x1)
    .orient("bottom");
// create left yAxis
var yAxisLeft = d3.svg.axis().scale(y0).ticks(4).orient("left");
// create right yAxis
var yAxisRight = d3.svg.axis().scale(y1).ticks(4).orient("right");	

		
  x1.domain(overall.map(function(d) { return d.age1+ " to "+ d.age2; }));

  y0.domain([0, d3.max(overall, function(d) {
									 if(d.male>d.female){return d.male;}
                                                    else{return d.female;} 
											})]);

  y1.domain([0, d3.max(overall, function(d) { 
									if(d.male>d.female){return d.male;}
									else{return d.female;} 
									        })]);

	
	canvas2.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + h2 + ")")
      .call(xAxis1)
      .append("text")
    .attr("x", 6)
    .attr("dx", "5em")
	.attr("dy", "3em")
    .style("text-anchor", "begin")
    .text("No. of deaths by age group and gender");

  canvas2.append("g")
    .attr("class", "y axis axisLeft")
    .attr("transform", "translate(0,0)")
    .call(yAxisLeft)
  .append("text")
  .attr("x", 10)
    .attr("y", 15)
    .attr("dy", "-2em")
    .style("text-anchor", "end")
    .text("Deaths");	
	
bars = canvas2.selectAll(".bar").data(overall).enter();

bars.append("rect")
      .attr("class", "bar1")
      .attr("x", function(d) { return x1(d.age); })
      .attr("width", x1.rangeBand()/2)
      .attr("y", function(d) { return y0(d.male); })
      .attr("height", function(d,i,j) { return h2 - y0(d.male); }) 
	  //tryyyyyyyyyyyyyyyy
	  //.on("mouseover", function(d){            /// <vamshi> added on click here, you need to figure out how to erase first plot and show 2nd one. you will either have to use remove() or visibility().
		
		//place_victims_onclick();				/// <vamshi> this function is placing all the 571 points when you click, you need to find a way to count the people till this day and show those in the plot.
			
		//})
  bars.append("rect")
      .attr("class", "bar2")
      .attr("x", function(d) { return x1(d.age) + x1.rangeBand()/2; })
      .attr("width", x1.rangeBand() / 2)
      .attr("y", function(d) { return y1(d.female); })
      .attr("height", function(d,i,j) { return h2 - y1(d.female); }) 
	  
	  //Tryyyyyyyy
	  //.on("mouseover", function(d){            /// <vamshi> added on click here, you need to figure out how to erase first plot and show 2nd one. you will either have to use remove() or visibility().
		
		//place_victims_onclick();				/// <vamshi> this function is placing all the 571 points when you click, you need to find a way to count the people till this day and show those in the plot.
			
		//})
		
		
	//Text for female bars	
	canvas2.selectAll("text.bar")
		   .data(overall)
           .enter().append("text")
						.text(function(d) {return d.female;})
						.attr("text-anchor", "middle")
						.attr("x", function(d, i) {return x1(d.age) + x1.rangeBand()/1.35;})
						.attr("y", function(d) {return y1(d.female)-2;})
						.attr("font-family", "sans-serif")
						.attr("font-size", "11px")
						.attr("fill", "gray");
						
	//Text for male bars
	canvas2.selectAll("text.bar")
  				.data(overall)
				.enter().append("text")
						.text(function(d) {return d.male;})
						.attr("text-anchor", "middle")
						.attr("x", function(d, i) {return x1(d.age) + x1.rangeBand()/4;})
						.attr("y", function(d) {return y0(d.male)-2;})
						.attr("font-family", "sans-serif")
						.attr("font-size", "11px")
						.attr("fill", "gray");

				
});	












				
//for line chart	  
var	margin1 = {top: 30, right: 20, bottom: 30, left: 50},
	w1 = 1300 - margin1.left - margin1.right,        // <> updated to 1300
	h1 = 400 - margin1.top - margin1.bottom;
	
//Line Chart to plot death days

// Parse the date / time
var	parseDate = d3.time.format("%d-%b").parse;
var formatTime = d3.time.format("%e %B");

// Set the ranges
var	x = d3.time.scale().range([650, w1]);     // <> updated to 650
var	y = d3.scale.linear().range([h1, 0]);

// Define the axes
var	xAxis = d3.svg.axis().scale(x)
	.orient("bottom").ticks(5);

var	yAxis = d3.svg.axis().scale(y)
	.orient("left").ticks(8);
	
var	line = d3.svg.line()
.x(function(d) { return x(d.date); })
.y(function(d) { return y(d.deaths); });

// svg for line chart	
var	canvas1 = d3.select("#main")
		.append("svg")
		.attr("width", w1 + margin1.left - margin1.right+200)
		.attr("height", 3*h1 + margin1.top + margin1.bottom)
		.append("g")
		.attr("transform", "translate(100,20)");
		
/*var canvas2 =d3.select("#main")
		.append("svg")
		.attr("width", w1 + margin1.left - margin1.right+200)
		.attr("height", 3*h1 + margin1.top + margin1.bottom)
		.append("g")
		.attr("class", "graph")
		.attr("transform", "translate(50,700)")  */


	d3.csv('data/deathdays.csv', function(data) 
		{
		data.forEach(function(d) 
		{
			d.date = parseDate(d.date);
			d.deaths = +d.deaths;
		});
		
/*	div.transition()    
                .duration(0)    
                .style("opacity", .9);    
            //div .html(formatTime(d.date) + "<br/>"  + d.deaths + " total:"+l)  
                .style("left", (d3.event.pageX) + "px")   
                .style("top", (d3.event.pageY - 28) + "px");  */
		
	//Scale the data	
		x.domain(d3.extent(data, function(d) {return d.date;}));
		y.domain([0, d3.max(data, function(d) {return d.deaths;})]);
		
	// Add the X Axis
	canvas1.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(100," + h1 + ")")
		.call(xAxis)
		.append("text")
                .attr("transform", "translate(600,10)")
                .attr("x", 300)
                .attr("dy", "2em")
                .style("text-anchor", "end")
                .text("TimeLine of number of deaths over a period of time");;

	// Add the Y Axis
	canvas1.append("g")
		.attr("class", "y axis")
		.call(yAxis)
		.attr('transform','translate(650,0)')               // <> added the transform attribute here
		.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 2)
                .attr("dy", "-3em")
                .style("text-anchor", "end")
                .text("Number of deaths");;		
		
	// Add the path.
	canvas1.append("path")
		.attr("class", "line")
		.attr("d", line(data))
		.attr("stroke", "grey")
   		.attr("stroke-width", "2px");
		
	canvas1.selectAll("dot")  
        .data(data)     
		.enter().append("ellipse")                 
        .attr("cx", function(d) { return x(d.date); })     
        .attr("cy", function(d) { return y(d.deaths); })
        .attr("rx", 3.5) 
        .attr("ry", 3.5)
        .style("fill", "white") 
        .attr("stroke", 'steelblue')
		.on("mouseover", function(d,i){            /// <vamshi> added on click here, you need to figure out how to erase first plot and show 2nd one. you will either have to use remove() or visibility().
		
		place_victims_onclick();				/// <vamshi> this function is placing all the 571 points when you click, you need to find a way to count the people till this day and show those in the plot.
			
		})
		.on("mouseout", function(d){            /// <vamshi> added on click here, you need to figure out how to erase first plot and show 2nd one. you will either have to use remove() or visibility().
		
		place_victims();				/// <vamshi> this function is placing all the 571 points when you click, you need to find a way to count the people till this day and show those in the plot.
			
		})
/*	 canvas1.selectAll("dot")  
        .data(label)     
		.enter().append("ellipse")                 
        .attr("cx", function(d) { return d.x; })     
        .attr("cy", function(d) { return d.y; })
        .attr("rx", 5) 
        .attr("ry", 5)
        .style("fill", function(d) { return d.color; }) 
        .style("stroke","grey")
        .style("stroke-width",1); 
		//.on("click", function(d) {   
         //   div.transition()    
           //     .duration(500)    
             //   .style("opacity", 0)
            //})  */
			
	/*	.on("click",function(d, i){

        	chart2.selectAll().remove();
        	chart2.selectAll("g").remove();

   			chart2.selectAll(".bar").remove();
   			chart2.selectAll("rect").remove();
   			chart2.selectAll("text.bar").remove();
   			chart2.selectAll("text").remove();



   			var l=0;

              for (a=0; a<=i; a++){

                 l= l+ sdata[a].death;



          } */
		
		});
		
		var victims = [];    /// ///  added new variable to store victims info 
	
	d3.csv('data/deaths_age_sex.csv',function(error, victimsdata) {     //  separated the data read process of victims and plotting
						victims = 	victimsdata;
						console.log(victims);
					    place_victims();
						});
						
						
	console.log(victims);
	
	//var color = d3.scale.category20b();
	var color = ['#b2182b', '#ef8a62', '#fddbc7', '#d1e5f0', '#67a9cf', '#2166ac']
		function place_victims(){													//  first function to place victims on load
		
				   gvictim.selectAll("rect")
					.data(victims)
					.enter()
					.append("rect")
					.attr("x", function(d) { return d.x*30; })
					.attr("y", function(d) { return height -d.y*30; })
					.attr('width', 5)
					.attr('height',7)
					.style('fill', function(d)
					  {
						if(d.gender == "0")
						{return "blue";}
						else
						{return "lime";}
					  }
					)
					.attr("stroke", 'steelblue')
					.attr("stroke-opacity",0.8);
					} 
					
		function place_victims_onclick(d,i){									// 2nd function to place the victims on click
		
				  gvictim.selectAll("rect").remove();
				  //canvas2.selectAll().remove();
				  //canvas2.selectAll("gvictim").remove();
				  
				  
		d3.csv('data/deaths_age_sex.csv',function(deathagesex) {

		deathagesex.forEach(function(d){
		sdata.push({
			x: d.x*30,
			y: height-d.y*30,
			age: d.age,
			gender: d.gender
		});
		});
		
		console.log(sdata);

				  
				  gvictim.selectAll("rect")
					.data(sdata)
					.attr("id","victims")
					.enter()
					.append("rect")
					.attr("x", function(d) { return d.x*30; })
					.attr("y", function(d) { return height-d.y*30; })
					.attr('width', 5)
					.attr('height',7)
					.style("fill", function(d) { return color[d.age]; })
					.attr("stroke", "black")
					.attr("stroke-width", "1px");
					
					})

			 div.transition()    
                .duration(0)    
                .style("opacity", .9);    
            div .html(formatTime(d.date) + "<br/>"  + d.deaths + " total:"+l)  
                .style("left", (d3.event.pageX) + "px")   
                .style("top", (d3.event.pageY - 28) + "px");

				
			var l=0;

              for (a=0; a<=i; a++){

                 l= l+ sdata[a].deaths;	  
				  
		}
		}
		
	/*	console.log(sdata);		  
				  gvictim.selectAll("rect")
					.data(sdata)
					.attr("id","victims")
					.enter()
					.append("rect")
					.attr("x", function(d) { return d.x*30; })
					.attr("y", function(d) { return height-d.y*30; })
					.attr('width', 5)
					.attr('height',7)
					.style('fill', function(d)
					  {
						if(d.gender == "0")
						{return "blue";}
						else
						{return "lime";}
					  }
					)
					

	
			
			//deathagesex_total();
				
			var l=0;

              for (a=0; a<=i; a++)
			  {l= l+ victims[a].death;}
					
			var color = d3.scale.category20b();
			
		var age0m=0; var age0f=0; var age11f=0; var age11m=0; 
   			var age21f=0; var age21m=0; var age41f=0; var age41m=0; 
   			var age61f=0; var age61m=0; var age81f=0; var age81m=0;

		for (b=0;b<sdata.length;b++)
   			{
   				
   				var s=Number(sdata[b].age);
   				switch(s)
   				{

   					case 0:
   				

   						if(sdata[b].gender==0)
   						{
   							age0m+=1;
   						}else{
   							age0f+=1;
   						}

   						break;

   					case 1:

   						if(sdata[b].gender==0)
   						{
   							age11m+=1;
   						}else{
   							age11f+=1;
   						}

   						break;

   					case 2:
   						if(sdata[b].gender==0)
   						{
   							age21m+=1;
   						}else{
   							age21f+=1;
   						}

   						break;

   					case 3:
   						if(sdata[b].gender==0)
   						{
   							age41m+=1;
   						}else{
   							age41f+=1;
   						}

   						break;

   					case 4:
   						if(sdata[b].gender==0)
   						{
   							age61m+=1;
   						}else{
   							age61f+=1;
   						}

   						break;

   					case 5:
   						if(sdata[b].gender==0)
   						{
   							age81m+=1;
   						}else{
   							age81f+=1;
   						}

   						break;

   					default:
   					    console.log("errorrrr");
   				}

   			}

var overall = [{age: 5, male: age0m, female: age0f,age1:0,age2:10},
			   {age: 15, male: age11m, female: age11f,age1:11,age2:20},
   			   {age: 30, male: age21m, female: age21f,age1:21,age2:40},
			   {age: 50, male: age41m, female: age41f,age1:41,age2:60},
   			   {age: 70, male: age61m, female: age61f,age1:61,age2:80},
			   {age: 85, male: age81m, female: age81f,age1:80,age2:"higher"}]

console.log(overall);

var margin2 = {top: 80, right: 80, bottom: 80, left: 80},
    w2 = 600 - margin2.left - margin2.right,        // <> updated from 1380 to 600
    h2 = 400 - margin2.top - margin2.bottom;

var x1 = d3.scale.ordinal().rangeRoundBands([0, w2], .1);
var y0 = d3.scale.linear().domain([0, 100]).range([h2, 0]);
var y1 = d3.scale.linear().domain([0, 100]).range([h2, 0]);
var xAxis1 = d3.svg.axis()
    .scale(x1)
    .orient("bottom");
// create left yAxis
var yAxisLeft = d3.svg.axis().scale(y0).ticks(4).orient("left");
// create right yAxis
var yAxisRight = d3.svg.axis().scale(y1).ticks(4).orient("right");
			
			
  x1.domain(overall.map(function(d) { return d.age1+ " to "+ d.age2; }));

  y0.domain([0, d3.max(overall, function(d) {
									 if(d.male>d.female){return d.male;}
                                                    else{return d.female;} 
											})]);

  y1.domain([0, d3.max(overall, function(d) { 
									if(d.male>d.female){return d.male;}
									else{return d.female;} 
									        })]);

	
  canvas2.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + h2 + ")")
      .call(xAxis1)
      .append("text")
	  


  canvas2.append("g")
    .attr("class", "y axis axisLeft")
    .attr("transform", "translate(0,0)")
    .call(yAxisLeft)
  .append("text")
  .attr("x", 10)
    .attr("y", 15)
    .attr("dy", "-2em")
    .style("text-anchor", "end")
    .text("Deaths");	
	
bars = canvas2.selectAll(".bar").data(overall).enter();

bars.append("rect")
      .attr("class", "bar1")
      .attr("x", function(d) { return x1(d.age); })
      .attr("width", x1.rangeBand()/2)
      .attr("y", function(d) { return y0(d.male); })
      .attr("height", function(d,i,j) { return h2 - y0(d.male); }) 
	  //tryyyyyyyyyyyyyyyy
	 // .on("mouseover", function(d){            /// <vamshi> added on click here, you need to figure out how to erase first plot and show 2nd one. you will either have to use remove() or visibility().
		
	//	place_victims_onclick();				/// <vamshi> this function is placing all the 571 points when you click, you need to find a way to count the people till this day and show those in the plot.
			
		//})
  bars.append("rect")
      .attr("class", "bar2")
      .attr("x", function(d) { return x1(d.age) + x1.rangeBand()/2; })
      .attr("width", x1.rangeBand() / 2)
      .attr("y", function(d) { return y1(d.female); })
      .attr("height", function(d,i,j) { return h2 - y1(d.female); }) 
	  
	  //Tryyyyyyyy
	 // .on("mouseover", function(d){            /// <vamshi> added on click here, you need to figure out how to erase first plot and show 2nd one. you will either have to use remove() or visibility().
		
		//place_victims_onclick();				/// <vamshi> this function is placing all the 571 points when you click, you need to find a way to count the people till this day and show those in the plot.
			
		//})
		
		
	//Text for female bars	
	canvas2.selectAll("text.bar")
		   .data(overall)
           .enter().append("text")
						.text(function(d) {return d.female;})
						.attr("text-anchor", "middle")
						.attr("x", function(d, i) {return x1(d.age) + x1.rangeBand()/1.35;})
						.attr("y", function(d) {return y1(d.female)-2;})
						.attr("font-family", "sans-serif")
						.attr("font-size", "11px")
						.attr("fill", "gray");
						
	//Text for male bars
	canvas2.selectAll("text.bar")
  				.data(overall)
				.enter().append("text")
						.text(function(d) {return d.male;})
						.attr("text-anchor", "middle")
						.attr("x", function(d, i) {return x1(d.age) + x1.rangeBand()/4;})
						.attr("y", function(d) {return y0(d.male)-2;})
						.attr("font-family", "sans-serif")
						.attr("font-size", "11px")
						.attr("fill", "gray");
	
			
			
			
			
	})		
	}		
			
			
			
   /*     .on("mouseover",function(d, i){

          //d3.select("svg").append("g").selectAll("circle").remove();

          d3.selectAll("circle").remove();

          var l=0;

              for (a=0; a<=i; a++){

                 l= l+ sdata[a].death;



          }

          div.transition()    
                .duration(0)    
                .style("opacity", .9);    
            div .html(formatTime(d.date) + "<br/>"  + d.death + " total:"+l)  
                .style("left", (d3.event.pageX) + "px")   
                .style("top", (d3.event.pageY - 28) + "px"); 
				
				*/
					
					
/* To draw Bar Charts

	
var x1 = d3.scale.ordinal().rangeRoundBands([0, w2], .1);
var y1 = d3.scale.linear().domain([0, 900]).range([h2, 0]);
	//y1 = d3.scale.linear().domain([0, 100]).range([h2, 0]);
	
var xAxis1 = d3.svg.axis()
    .scale(x1)
    .orient("bottom");
// create left yAxis
var yAxis1 = d3.svg.axis().scale(y1).ticks(4).orient("left");
// create right yAxis
//var yAxisRight = d3.svg.axis().scale(y1).ticks(4).orient("right");	

var margin2 = {top: 80, right: 80, bottom: 80, left: 80},
    w2 = 1380 - margin2.left - margin2.right,        // <> updated to 1380
    h2 = 400 - margin2.top - margin2.bottom;
	
var svgbar = d3.select("main")
    .append("svg")
		.attr("width", w2 + margin2.left - margin2.right)
		.attr("height", 3*h2 + margin2.top + margin2.bottom)
		.append("g")
		.attr("transform", "translate(185,10)");
		
		
var g = svgbar.append("g")
    .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");
	
d3.tsv("data/agedeathpercentage.tsv", function(d) {
  d.percentage_of_deaths = +d.percentage_of_deaths;
  return d;
}, function(error, data) {
  if (error) throw error;

  x.domain(data.map(function(d) { return d.age_group; }));
  y.domain([0, d3.max(data, function(d) { return d.percentage_of_deaths; })]);
  
  // Add the X Axis
	svgbar.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(100," + h2 + ")")
		.call(xAxis1)
		.append("text")
                .attr("transform", "translate(600,10)")
                .attr("x", 300)
                .attr("dy", "2em")
                .style("text-anchor", "end")
                .text("Age Group");

  /*g.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + h2 + ")")
      .call(d3.svg.axis(x1));  
	  
	// Add the Y Axis
	svgbar.append("g")
		.attr("class", "y axis")
		.call(yAxis1)
		.attr('transform','translate(650,0)')               // <> added the transform attribute here.
		//.append("text")
		//.attr("x", -25)
       // .attr("y", -2)
		.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 2)
                .attr("dy", "-3em")
                .style("text-anchor", "end")
                .text("Percentage of deaths");		

/*  g.append("g")
      .attr("class", "axis axis--y")
      .call(d3.svg.axis(y1).ticks(10, "%"))
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y1", 6)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("percentage_of_deaths"); 
	  
	// Add the path.
	svgbar.selectAll(".bar")
		  .data(data)
		  .enter().append("rect")
				.attr("class", "bar")
				.attr("x", function(d) { return x(d.age_group); })
				.attr("y", function(d) { return y(d.percentage_of_deaths); })
				.attr("width", 10)
				.attr("height", function(d) { return height - y(d.percentage_of_deaths); })
				.attr("stroke", "grey")
				.attr("stroke-width", "2px");

 /* g.selectAll(".bar")
    .data(data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x1", function(d) { return x1(d.age_group); })
      .attr("y1", function(d) { return y1(d.percentage_of_deaths); })
      .attr("width", 10)
      .attr("height", function(d) { return height - y1(d.percentage_of_deaths); });  
});		
	*/

</script>		
		



				
</body>
</html>					